<h1>Nuevo Chat</h1>

<div class="card">
  <div class="card-body">
    <p class="text-muted">Remitente: <%= current_user.email %></p>

    <%= form_with(model: @chat, local: true) do |form| %>
      <% if @chat.errors.any? %>
        <div class="alert alert-danger">
          <h2><%= pluralize(@chat.errors.count, "error") %> impidieron guardar este chat:</h2>
          <ul>
            <% @chat.errors.full_messages.each do |msg| %>
              <li><%= msg %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <div class="mb-3">
        <%= form.label :receiver_id, "Destinatario", class: "form-label" %>
        <%= form.collection_select :receiver_id, User.where.not(id: current_user.id), :id, :email, 
            { prompt: "Seleccionar destinatario" }, { class: "form-select" } %>
      </div>

      <div class="mt-3">
        <%= form.submit "Crear Chat", class: "btn btn-primary" %>
        <%= link_to "Volver a Chats", chats_path, class: "btn btn-secondary" %>
      </div>
    <% end %>
  </div>
</div>